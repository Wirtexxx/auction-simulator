"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const c=require("@tma.js/toolkit"),o=require("fp-ts"),t=require("valibot");function O(r){const e=n=>{const i={};return new URLSearchParams(n).forEach((a,u)=>{const p=i[u];Array.isArray(p)?p.push(a):p===void 0?i[u]=a:i[u]=[p,a]}),t.parse(r,i)};return t.pipe(t.union([t.string(),t.instance(URLSearchParams)]),t.check(n=>{try{return e(n),!0}catch{return!1}},"The value doesn't match required schema"),t.transform(e))}function $(r){return t.pipe(t.string(),t.check(e=>{try{return JSON.parse(e),!0}catch{return!1}},"Input is not a valid JSON value"),t.transform(JSON.parse),r)}function s(r){return t.pipe(t.string(),$(r))}function m(r){return t.pipe(t.union([t.string(),t.instance(URLSearchParams)]),O(r))}function f(r){return e=>r.test(e)}const S=f(/^#[\da-f]{3}$/i),R=f(/^#[\da-f]{4}$/i),A=f(/^#[\da-f]{6}$/i),B=f(/^#[\da-f]{8}$/i);function P(r){return[A,B,S,R].some(e=>e(r))}function b(r){let e="#";for(let n=0;n<r.length-1;n+=1)e+=r[1+n].repeat(2);return e}function g(r){const e=r.replace(/\s/g,"").toLowerCase();if(/^#[\da-f]{3}$/i.test(e))return o.either.right(b(e.toLowerCase()+"f"));if(/^#[\da-f]{4}$/i.test(e))return o.either.right(b(e.toLowerCase()));if(/^#[\da-f]{6}$/i.test(e))return o.either.right(e.toLowerCase()+"ff");if(/^#[\da-f]{8}$/i.test(e))return o.either.right(e.toLowerCase());const n=e.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||e.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),(\d{1,3})\)$/);return n?o.either.right(n.slice(1).reduce((i,a)=>i+parseInt(a,10).toString(16).padStart(2,"0"),"#").padEnd(9,"f")):o.either.left(new Error(`Value "${r}" does not satisfy any of known RGB formats.`))}function Q(r){return o.function.pipe(g(r),o.either.map(e=>e.slice(0,7)))}const C=c.throwifyFpFn(Q),W=c.throwifyFpFn(g);function F(){return t.looseObject({id:t.number(),photo_url:t.optional(t.string()),type:t.string(),title:t.string(),username:t.optional(t.string())})}function h(){return t.looseObject({added_to_attachment_menu:t.optional(t.boolean()),allows_write_to_pm:t.optional(t.boolean()),first_name:t.string(),id:t.number(),is_bot:t.optional(t.boolean()),is_premium:t.optional(t.boolean()),last_name:t.optional(t.string()),language_code:t.optional(t.string()),photo_url:t.optional(t.string()),username:t.optional(t.string())})}function _(){return t.looseObject({auth_date:t.pipe(t.string(),t.transform(r=>new Date(Number(r)*1e3)),t.date()),can_send_after:t.optional(t.pipe(t.string(),t.transform(Number),t.integer())),chat:t.optional(s(F())),chat_type:t.optional(t.string()),chat_instance:t.optional(t.string()),hash:t.string(),query_id:t.optional(t.string()),receiver:t.optional(s(h())),start_param:t.optional(t.string()),signature:t.string(),user:t.optional(s(h()))})}function y(){return m(_())}function l(){return t.record(t.string(),t.pipe(t.union([t.string(),t.number()]),t.transform(r=>typeof r=="number"?`#${(r&16777215).toString(16).padStart(6,"0")}`:r),t.check(P)))}function D(){const r=t.optional(t.pipe(t.string(),t.transform(e=>e==="1")));return t.looseObject({tgWebAppBotInline:r,tgWebAppData:t.optional(y()),tgWebAppDefaultColors:t.optional(s(l())),tgWebAppFullscreen:r,tgWebAppPlatform:t.string(),tgWebAppShowSettings:r,tgWebAppStartParam:t.optional(t.string()),tgWebAppThemeParams:s(l()),tgWebAppVersion:t.string()})}function d(){return m(D())}function I(r){try{return t.is(d(),r)}catch{return!1}}function J(){return t.looseObject({eventType:t.string(),eventData:t.optional(t.unknown())})}function G(r){return o.either.tryCatch(()=>t.parse(y(),r),e=>e)}function w(r){return o.either.tryCatch(()=>t.parse(d(),r),e=>e)}const N=c.throwifyFpFn(G),j=c.throwifyFpFn(w);function L(r,e){return e||(e=(n,i)=>JSON.stringify(i)),new URLSearchParams(Object.entries(r).reduce((n,[i,a])=>(Array.isArray(a)?n.push(...a.map(u=>[i,String(u)])):a!=null&&n.push([i,a instanceof Date?(a.getTime()/1e3|0).toString():typeof a=="string"||typeof a=="number"?String(a):typeof a=="boolean"?a?"1":"0":e(i,a)]),n),[])).toString()}function T(r){return L(r)}function U(r){return L(r,(e,n)=>e==="tgWebAppData"?T(n):JSON.stringify(n))}exports.initData=_;exports.initDataChat=F;exports.initDataQuery=y;exports.initDataUser=h;exports.isAnyRGB=P;exports.isLaunchParamsQuery=I;exports.isRGB=A;exports.isRGBA=B;exports.isRGBAShort=R;exports.isRGBShort=S;exports.launchParams=D;exports.launchParamsQuery=d;exports.miniAppsMessage=J;exports.parseInitDataQuery=N;exports.parseInitDataQueryFp=G;exports.parseLaunchParamsQuery=j;exports.parseLaunchParamsQueryFp=w;exports.pipeJsonToSchema=s;exports.pipeQueryToSchema=m;exports.serializeInitDataQuery=T;exports.serializeLaunchParamsQuery=U;exports.themeParams=l;exports.toRGB=C;exports.toRGBFp=Q;exports.toRGBFull=W;exports.toRGBFullFp=g;
//# sourceMappingURL=index.cjs.map
