this.tapps=this.tapps||{};this.tapps.bridge=function(f){"use strict";var j;function We(e){return{lang:(e==null?void 0:e.lang)??(j==null?void 0:j.lang),message:e==null?void 0:e.message,abortEarly:(e==null?void 0:e.abortEarly)??(j==null?void 0:j.abortEarly),abortPipeEarly:(e==null?void 0:e.abortPipeEarly)??(j==null?void 0:j.abortPipeEarly)}}var ue;function Gt(e){return ue==null?void 0:ue.get(e)}var oe;function Jt(e){return oe==null?void 0:oe.get(e)}var ce;function Bt(e,t){var n;return(n=ce==null?void 0:ce.get(e))==null?void 0:n.get(t)}function Kt(e){var n,r;const t=typeof e;return t==="string"?`"${e}"`:t==="number"||t==="bigint"||t==="boolean"?`${e}`:t==="object"||t==="function"?(e&&((r=(n=Object.getPrototypeOf(e))==null?void 0:n.constructor)==null?void 0:r.name))??"null":t}function w(e,t,n,r,s){const a=s&&"input"in s?s.input:n.value,i=(s==null?void 0:s.expected)??e.expects??null,o=(s==null?void 0:s.received)??Kt(a),c={kind:e.kind,type:e.type,input:a,expected:i,received:o,message:`Invalid ${t}: ${i?`Expected ${i} but r`:"R"}eceived ${o}`,requirement:e.requirement,path:s==null?void 0:s.path,issues:s==null?void 0:s.issues,lang:r.lang,abortEarly:r.abortEarly,abortPipeEarly:r.abortPipeEarly},u=e.kind==="schema",l=(s==null?void 0:s.message)??e.message??Bt(e.reference,c.lang)??(u?Jt(c.lang):null)??r.message??Gt(c.lang);l!==void 0&&(c.message=typeof l=="function"?l(c):l),u&&(n.typed=!1),n.issues?n.issues.push(c):n.issues=[c]}function E(e){return{version:1,vendor:"valibot",validate(t){return e["~run"]({value:t},We())}}}function De(e,t){return Object.hasOwn(e,t)&&t!=="__proto__"&&t!=="prototype"&&t!=="constructor"}function Ht(e,t){const n=[...new Set(e)];return n.length>1?`(${n.join(` ${t} `)})`:n[0]??"never"}var Qt=class extends Error{constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}};function Q(e,t){return{kind:"validation",type:"check",reference:Q,async:!1,expects:null,requirement:e,message:t,"~run"(n,r){return n.typed&&!this.requirement(n.value)&&w(this,"input",n,r),n}}}function Ue(e){return{kind:"validation",type:"integer",reference:Ue,async:!1,expects:null,requirement:Number.isInteger,message:e,"~run"(t,n){return t.typed&&!this.requirement(t.value)&&w(this,"integer",t,n),t}}}function R(e){return{kind:"transformation",type:"transform",reference:R,async:!1,operation:e,"~run"(t){return t.value=this.operation(t.value),t}}}function Xt(e,t,n){return typeof e.fallback=="function"?e.fallback(t,n):e.fallback}function le(e,t,n){return typeof e.default=="function"?e.default(t,n):e.default}function fe(e,t){return!e["~run"]({value:t},{abortEarly:!0}).issues}function Ne(){return{kind:"schema",type:"any",reference:Ne,expects:"any",async:!1,get"~standard"(){return E(this)},"~run"(e){return e.typed=!0,e}}}function I(e){return{kind:"schema",type:"boolean",reference:I,expects:"boolean",async:!1,message:e,get"~standard"(){return E(this)},"~run"(t,n){return typeof t.value=="boolean"?t.typed=!0:w(this,"type",t,n),t}}}function xe(e){return{kind:"schema",type:"date",reference:xe,expects:"Date",async:!1,message:e,get"~standard"(){return E(this)},"~run"(t,n){return t.value instanceof Date?isNaN(t.value)?w(this,"type",t,n,{received:'"Invalid Date"'}):t.typed=!0:w(this,"type",t,n),t}}}function pe(e){return{kind:"schema",type:"function",reference:pe,expects:"Function",async:!1,message:e,get"~standard"(){return E(this)},"~run"(t,n){return typeof t.value=="function"?t.typed=!0:w(this,"type",t,n),t}}}function _e(e,t){return{kind:"schema",type:"instance",reference:_e,expects:e.name,async:!1,class:e,message:t,get"~standard"(){return E(this)},"~run"(n,r){return n.value instanceof this.class?n.typed=!0:w(this,"type",n,r),n}}}function g(e,t){return{kind:"schema",type:"loose_object",reference:g,expects:"Object",async:!1,entries:e,message:t,get"~standard"(){return E(this)},"~run"(n,r){var a;const s=n.value;if(s&&typeof s=="object"){n.typed=!0,n.value={};for(const i in this.entries){const o=this.entries[i];if(i in s||(o.type==="exact_optional"||o.type==="optional"||o.type==="nullish")&&o.default!==void 0){const c=i in s?s[i]:le(o),u=o["~run"]({value:c},r);if(u.issues){const l={type:"object",origin:"value",input:s,key:i,value:c};for(const p of u.issues)p.path?p.path.unshift(l):p.path=[l],(a=n.issues)==null||a.push(p);if(n.issues||(n.issues=u.issues),r.abortEarly){n.typed=!1;break}}u.typed||(n.typed=!1),n.value[i]=u.value}else if(o.fallback!==void 0)n.value[i]=Xt(o);else if(o.type!=="exact_optional"&&o.type!=="optional"&&o.type!=="nullish"&&(w(this,"key",n,r,{input:void 0,expected:`"${i}"`,path:[{type:"object",origin:"key",input:s,key:i,value:s[i]}]}),r.abortEarly))break}if(!n.issues||!r.abortEarly)for(const i in s)De(s,i)&&!(i in this.entries)&&(n.value[i]=s[i])}else w(this,"type",n,r);return n}}}function L(e,t){return{kind:"schema",type:"nullish",reference:L,expects:`(${e.expects} | null | undefined)`,async:!1,wrapped:e,default:t,get"~standard"(){return E(this)},"~run"(n,r){return(n.value===null||n.value===void 0)&&(this.default!==void 0&&(n.value=le(this,n,r)),n.value===null||n.value===void 0)?(n.typed=!0,n):this.wrapped["~run"](n,r)}}}function W(e){return{kind:"schema",type:"number",reference:W,expects:"number",async:!1,message:e,get"~standard"(){return E(this)},"~run"(t,n){return typeof t.value=="number"&&!isNaN(t.value)?t.typed=!0:w(this,"type",t,n),t}}}function d(e,t){return{kind:"schema",type:"optional",reference:d,expects:`(${e.expects} | undefined)`,async:!1,wrapped:e,default:t,get"~standard"(){return E(this)},"~run"(n,r){return n.value===void 0&&(this.default!==void 0&&(n.value=le(this,n,r)),n.value===void 0)?(n.typed=!0,n):this.wrapped["~run"](n,r)}}}function ze(e,t,n){return{kind:"schema",type:"record",reference:ze,expects:"Object",async:!1,key:e,value:t,message:n,get"~standard"(){return E(this)},"~run"(r,s){var i,o;const a=r.value;if(a&&typeof a=="object"){r.typed=!0,r.value={};for(const c in a)if(De(a,c)){const u=a[c],l=this.key["~run"]({value:c},s);if(l.issues){const h={type:"object",origin:"key",input:a,key:c,value:u};for(const m of l.issues)m.path=[h],(i=r.issues)==null||i.push(m);if(r.issues||(r.issues=l.issues),s.abortEarly){r.typed=!1;break}}const p=this.value["~run"]({value:u},s);if(p.issues){const h={type:"object",origin:"value",input:a,key:c,value:u};for(const m of p.issues)m.path?m.path.unshift(h):m.path=[h],(o=r.issues)==null||o.push(m);if(r.issues||(r.issues=p.issues),s.abortEarly){r.typed=!1;break}}(!l.typed||!p.typed)&&(r.typed=!1),l.typed&&(r.value[l.value]=p.value)}}else w(this,"type",r,s);return r}}}function _(e){return{kind:"schema",type:"string",reference:_,expects:"string",async:!1,message:e,get"~standard"(){return E(this)},"~run"(t,n){return typeof t.value=="string"?t.typed=!0:w(this,"type",t,n),t}}}function Ve(e){let t;if(e)for(const n of e)t?t.push(...n.issues):t=n.issues;return t}function X(e,t){return{kind:"schema",type:"union",reference:X,expects:Ht(e.map(n=>n.expects),"|"),async:!1,options:e,message:t,get"~standard"(){return E(this)},"~run"(n,r){let s,a,i;for(const o of this.options){const c=o["~run"]({value:n.value},r);if(c.typed)if(c.issues)a?a.push(c):a=[c];else{s=c;break}else i?i.push(c):i=[c]}if(s)return s;if(a){if(a.length===1)return a[0];w(this,"type",n,r,{issues:Ve(a)}),n.typed=!0}else{if((i==null?void 0:i.length)===1)return i[0];w(this,"type",n,r,{issues:Ve(i)})}return n}}}function he(){return{kind:"schema",type:"unknown",reference:he,expects:"unknown",async:!1,get"~standard"(){return E(this)},"~run"(e){return e.typed=!0,e}}}function V(e,t,n){const r=e["~run"]({value:t},We(n));if(r.issues)throw new Qt(r.issues);return r.value}function A(...e){return{...e[0],pipe:e,get"~standard"(){return E(this)},"~run"(t,n){for(const r of e)if(r.kind!=="metadata"){if(t.issues&&(r.kind==="schema"||r.kind==="transformation")){t.typed=!1;break}(!t.issues||!n.abortEarly&&!n.abortPipeEarly)&&(t=r["~run"](t,n))}return t}}}function de(e){return fe(g({TelegramWebviewProxy:g({postEvent:pe()})}),e)}function me(){try{return window.self!==window.top}catch{return!0}}var Yt=Object.defineProperty,Zt=(e,t,n)=>t in e?Yt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ge=(e,t,n)=>Zt(e,typeof t!="symbol"?t+"":t,n),en=Object.defineProperty,tn=(e,t,n)=>t in e?en(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ye=(e,t,n)=>tn(e,typeof t!="symbol"?t+"":t,n);function Je(e){return t=>t instanceof e}function Be(e,t){const n=class extends Error{constructor(...s){const a=typeof t=="function"?t(...s):typeof t=="string"?[t]:t||[];super(...a),this.name=e}};ye(n,"is",Je(n));let r=n;return Object.defineProperty(r,"name",{value:e}),r}function nn(e,t,n){const r=class extends Be(e,n){constructor(...a){super(...a),ye(this,"data"),this.data=t(...a)}};ye(r,"is",Je(r));let s=r;return Object.defineProperty(s,"name",{value:e}),s}class Ke extends Be("CancelledError","Promise was canceled"){}let ve=class extends nn("TimeoutError",t=>({timeout:t}),(t,n)=>[`Timeout reached: ${t}ms`,{cause:n}]){};const rn=Symbol("resolved");function sn(e){return{tag:rn,value:e}}function He(e,t){return e.reject=t.reject,e.resolve=t.resolve,e}class F extends Promise{constructor(t,n){let r,s,a,i;typeof t=="function"?(a=t,i=n||{}):i=t||{};let o,c;const u=()=>!!c,l=()=>!!o;let p={};const h=[],m=()=>{h.forEach(qe=>qe()),h.splice(0,h.length),p={}},$=new AbortController,T=()=>l()||u();super((qe,Mr)=>{const{abortOnResolve:Rr=!0,abortOnReject:Ir=!0}=i;s=y=>{var M,k;T()||(qe(y),o=[y],(M=p.resolved)==null||M.forEach(P=>P(y)),(k=p.finalized)==null||k.forEach(P=>P({kind:"resolved",result:y})),m(),Rr&&$.abort(sn(y)))},r=y=>{var M,k;T()||(Mr(y),c=[y],(M=p.rejected)==null||M.forEach(P=>P(y)),(k=p.finalized)==null||k.forEach(P=>P({kind:"rejected",reason:y})),m(),Ir&&$.abort(y))};const{abortSignal:z}=i;if(z){if(z.aborted)return r(z.reason);const y=()=>{r(z.reason)};z.addEventListener("abort",y,!0),h.push(()=>{z.removeEventListener("abort",y,!0)})}const{timeout:Le}=i;if(Le){const y=setTimeout(()=>{r(new ve(Le))},Le);h.push(()=>{clearTimeout(y)})}try{const y=()=>{},M=a&&a(s,r,{abortSignal:$.signal,get isRejected(){return u()},get isResolved(){return l()},on(k,P){if(o||c){if(k==="finalized"){const ie=o?{kind:"resolved",result:o[0]}:{kind:"rejected",reason:c[0]};P(ie)}else k==="resolved"&&o?P(o[0]):k==="rejected"&&c&&P(c[0]);return y}return p[k]||(p[k]=[]),p[k].push(P),()=>{const ie=p[k]||[],Vt=ie.indexOf(P);Vt>=0&&ie.splice(Vt,1)}},get result(){return o==null?void 0:o[0]},get rejectReason(){return c==null?void 0:c[0]},throwIfRejected(){if(c)throw c[0]}});M instanceof Promise&&M.catch(r)}catch(y){r(y)}}),Ge(this,"reject"),Ge(this,"resolve"),this.reject=r,this.resolve=s}static fn(t,n){return new F(async(r,s,a)=>{try{r(await t(a))}catch(i){s(i)}},n)}static resolve(t){return this.fn(()=>t)}static reject(t){return new F((n,r)=>{r(t)})}cancel(){this.reject(new Ke)}catch(t){return this.then(void 0,t)}finally(t){return He(super.finally(t),this)}then(t,n){return He(super.then(t,n),this)}}var an=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,a;r<s;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))};function un(e){return e}function Qe(e,t,n,r,s,a,i,o,c){switch(arguments.length){case 1:return e;case 2:return function(){return t(e.apply(this,arguments))};case 3:return function(){return n(t(e.apply(this,arguments)))};case 4:return function(){return r(n(t(e.apply(this,arguments))))};case 5:return function(){return s(r(n(t(e.apply(this,arguments)))))};case 6:return function(){return a(s(r(n(t(e.apply(this,arguments))))))};case 7:return function(){return i(a(s(r(n(t(e.apply(this,arguments)))))))};case 8:return function(){return o(i(a(s(r(n(t(e.apply(this,arguments))))))))};case 9:return function(){return c(o(i(a(s(r(n(t(e.apply(this,arguments)))))))))}}}function v(e,t,n,r,s,a,i,o,c){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return n(t(e));case 4:return r(n(t(e)));case 5:return s(r(n(t(e))));case 6:return a(s(r(n(t(e)))));case 7:return i(a(s(r(n(t(e))))));case 8:return o(i(a(s(r(n(t(e)))))));case 9:return c(o(i(a(s(r(n(t(e))))))));default:{for(var u=arguments[0],l=1;l<arguments.length;l++)u=arguments[l](u);return u}}}var Y=function(e,t){var n=typeof e=="number"?function(r){return r.length>=e}:e;return function(){var r=Array.from(arguments);return n(arguments)?t.apply(this,r):function(s){return t.apply(void 0,an([s],r,!1))}}},on={_tag:"None"},cn=function(e){return{_tag:"Some",value:e}},ln=function(e){return e._tag==="Left"},Xe=function(e){return{_tag:"Left",left:e}},Ye=function(e){return{_tag:"Right",right:e}},fn=on,pn=cn,_n=function(e){return e._tag==="None"},hn=function(e,t){return function(n){return _n(n)?e():t(n.value)}},dn=hn,S=Xe,b=Ye,Ze=Y(2,function(e,t){return D(e)?e:t(e.right)}),mn=function(e){return function(t){return D(t)?t:b(e(t.right))}},yn=function(e,t){return function(n){return D(n)?S(e(n.left)):b(t(n.right))}},vn=function(e){return function(t){return D(t)?S(e(t.left)):t}},D=ln,et=function(e,t){return function(n){return D(n)?e(n.left):t(n.right)}},gn=et,G=et,bn=G,Z=function(e,t){try{return b(e())}catch(n){return S(t(n))}},wn=Ze,En=Ze;function kn(e){return Qe(b,e.of)}function Pn(e){return Qe(S,e.of)}function $n(e){return function(t,n){return e.chain(t,function(r){return D(r)?e.of(r):n(r.right)})}}function Sn(e){return function(t,n,r){return e.map(t,yn(n,r))}}function jn(e){return function(t,n){return function(r){return e.map(r,G(t,n))}}}var An=function(e){return Z(function(){return JSON.parse(e)},un)},tt=function(e,t){return v(e,Tn(t))},On=function(e,t){return v(e,Mn(t))},Tn=function(e){return function(t){return function(){return Promise.resolve().then(t).then(e)}}},Mn=function(e){return function(t){return function(){return Promise.all([Promise.resolve().then(t),Promise.resolve().then(e)]).then(function(n){var r=n[0],s=n[1];return r(s)})}}},ge=function(e){return function(){return Promise.resolve(e)}},Rn=Y(2,function(e,t){return function(){return Promise.resolve().then(e).then(function(n){return t(n)()})}}),nt="Task",rt={URI:nt,map:tt},st={of:ge},In={URI:nt,map:tt,of:ge,ap:On,chain:Rn},Fn=function(e,t,n,r){function s(a){return a instanceof n?a:new n(function(i){i(a)})}return new(n||(n=Promise))(function(a,i){function o(l){try{u(r.next(l))}catch(p){i(p)}}function c(l){try{u(r.throw(l))}catch(p){i(p)}}function u(l){l.done?a(l.value):s(l.value).then(o,c)}u((r=r.apply(e,t||[])).next())})},Cn=function(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,s,a,i;return i={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function o(u){return function(l){return c([u,l])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(n=0)),n;)try{if(r=1,s&&(a=u[0]&2?s.return:u[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,u[1])).done)return a;switch(s=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){n.label=u[1];break}if(u[0]===6&&n.label<a[1]){n.label=a[1],a=u;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(u);break}a[2]&&n.ops.pop(),n.trys.pop();continue}u=t.call(e,n)}catch(l){u=[6,l],s=0}finally{r=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},at=Pn(st),be=kn(st),qn=ge,ee=jn(rt),Ln=ee,Wn=function(e,t){return function(){return Fn(void 0,void 0,void 0,function(){var n;return Cn(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e().then(Ye)];case 1:return[2,r.sent()];case 2:return n=r.sent(),[2,Xe(t(n))];case 3:return[2]}})})}},it=Y(3,Sn(rt)),ut=Y(2,$n(In)),Dn=ut,we=ut;function Un(e){return e.replace(/_[a-z]/g,t=>t[1].toUpperCase())}function Nn(e){return Object.entries(e).reduce((t,[n,r])=>(t[Un(n)]=r,t),{})}function Ee(e){const t=Nn(e);for(const n in t){const r=t[n];r&&typeof r=="object"&&!(r instanceof Date)&&(t[n]=Array.isArray(r)?r.map(Ee):Ee(r))}return t}function ot(e){return`tapps/${e}`}function ct(e,t){sessionStorage.setItem(ot(e),JSON.stringify(t))}function xn(e){const t=sessionStorage.getItem(ot(e));try{return t?JSON.parse(t):void 0}catch{}}function lt(...e){const t=e.flat(1);return[t.push.bind(t),()=>{t.forEach(n=>{n()})}]}function ft(e,t){t||(t={});const{textColor:n,bgColor:r,shouldLog:s}=t,a=s===void 0?!0:s,i=typeof a=="boolean"?()=>a:a,o=(c,u,...l)=>{if(u||i()){const p="font-weight:bold;padding:0 5px;border-radius:100px",[h,m,$]={log:["#0089c3","white","INFO"],error:["#ff0000F0","white","ERR"],warn:["#D38E15","white","WARN"]}[c];console[c](`%c${$} ${Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,timeZone:"UTC"}).format(new Date)}%c %c${e}`,`${p};background-color:${h};color:${m}`,"",`${p};${n?`color:${n};`:""}${r?`background-color:${r}`:""}`,...l)}};return[["log","forceLog"],["warn","forceWarn"],["error","forceError"]].reduce((c,[u,l])=>(c[u]=o.bind(void 0,u,!1),c[l]=o.bind(void 0,u,!0),c),{})}function J(e){const t=n=>{throw n};return typeof e=="function"?F.resolve(v(e,ee(t,n=>n))()):v(e,G(t,n=>n))}function B(e){return Object.assign((...t)=>J(e(...t)),e)}const ke=Object.assign((e,t)=>v(Wn(()=>new F((n,r,s)=>e(a=>n(b(a)),a=>n(S(a)),s),t),n=>n),we(G(at,be))),{fn:(e,t)=>ke((n,r,s)=>{const a=e(s);v(typeof a=="function"?a:qn(a),Ln(r,n))()},t)});var zn=Object.defineProperty,Vn=(e,t,n)=>t in e?zn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Pe=(e,t,n)=>Vn(e,typeof t!="symbol"?t+"":t,n);function pt(e){return t=>t instanceof e}function U(e,t){const n=class extends Error{constructor(...a){const i=typeof t=="function"?t(...a):typeof t=="string"?[t]:t||[];super(...i),this.name=e}};Pe(n,"is",pt(n));let r=n;return Object.defineProperty(r,"name",{value:e}),r}function Gn(e,t,n){const r=class extends U(e,n){constructor(...i){super(...i),Pe(this,"data"),this.data=t(...i)}};Pe(r,"is",pt(r));let s=r;return Object.defineProperty(s,"name",{value:e}),s}class _t extends U("MethodUnsupportedError",(t,n)=>[`Method "${t}" is unsupported in Mini Apps version ${n}`]){}class ht extends U("MethodParameterUnsupportedError",(t,n,r)=>[`Parameter "${n}" of "${t}" method is unsupported in Mini Apps version ${r}`]){}class dt extends Gn("LaunchParamsRetrieveError",t=>({errors:t}),t=>[["Unable to retrieve launch parameters from any known source. Perhaps, you have opened your app outside Telegram?","ðŸ“– Refer to docs for more information:","https://docs.telegram-mini-apps.com/packages/tma-js-bridge/environment","","Collected errors:",...t.map(({source:n,error:r})=>`Source: ${n} / ${r instanceof Error?r.message:String(r)}`)].join(`
`)]){}class mt extends U("InvalidLaunchParamsError",(t,n)=>[`Invalid value for launch params: ${t}`,{cause:n}]){}class $e extends U("UnknownEnvError"){}class yt extends U("InvokeCustomMethodError",t=>[`Server returned error: ${t}`]){}function Jn(e){const t=n=>{const r={};return new URLSearchParams(n).forEach((s,a)=>{const i=r[a];Array.isArray(i)?i.push(s):i===void 0?r[a]=s:r[a]=[i,s]}),V(e,r)};return A(X([_(),_e(URLSearchParams)]),Q(n=>{try{return t(n),!0}catch{return!1}},"The value doesn't match required schema"),R(t))}function Bn(e){return A(_(),Q(t=>{try{return JSON.parse(t),!0}catch{return!1}},"Input is not a valid JSON value"),R(JSON.parse),e)}function C(e){return A(_(),Bn(e))}function vt(e){return A(X([_(),_e(URLSearchParams)]),Jn(e))}function te(e){return t=>e.test(t)}const Kn=te(/^#[\da-f]{3}$/i),Hn=te(/^#[\da-f]{4}$/i),Qn=te(/^#[\da-f]{6}$/i),Xn=te(/^#[\da-f]{8}$/i);function Yn(e){return[Qn,Xn,Kn,Hn].some(t=>t(e))}function Zn(){return g({id:W(),photo_url:d(_()),type:_(),title:_(),username:d(_())})}function gt(){return g({added_to_attachment_menu:d(I()),allows_write_to_pm:d(I()),first_name:_(),id:W(),is_bot:d(I()),is_premium:d(I()),last_name:d(_()),language_code:d(_()),photo_url:d(_()),username:d(_())})}function er(){return g({auth_date:A(_(),R(e=>new Date(Number(e)*1e3)),xe()),can_send_after:d(A(_(),R(Number),Ue())),chat:d(C(Zn())),chat_type:d(_()),chat_instance:d(_()),hash:_(),query_id:d(_()),receiver:d(C(gt())),start_param:d(_()),signature:_(),user:d(C(gt()))})}function tr(){return vt(er())}function Se(){return ze(_(),A(X([_(),W()]),R(e=>typeof e=="number"?`#${(e&16777215).toString(16).padStart(6,"0")}`:e),Q(Yn)))}function nr(){const e=d(A(_(),R(t=>t==="1")));return g({tgWebAppBotInline:e,tgWebAppData:d(tr()),tgWebAppDefaultColors:d(C(Se())),tgWebAppFullscreen:e,tgWebAppPlatform:_(),tgWebAppShowSettings:e,tgWebAppStartParam:d(_()),tgWebAppThemeParams:C(Se()),tgWebAppVersion:_()})}function rr(){return vt(nr())}function bt(){return g({eventType:_(),eventData:d(he())})}function je(e){return Z(()=>V(rr(),e),t=>t)}const sr=B(je);function wt(e,t){return t||(t=(n,r)=>JSON.stringify(r)),new URLSearchParams(Object.entries(e).reduce((n,[r,s])=>(Array.isArray(s)?n.push(...s.map(a=>[r,String(a)])):s!=null&&n.push([r,s instanceof Date?(s.getTime()/1e3|0).toString():typeof s=="string"||typeof s=="number"?String(s):typeof s=="boolean"?s?"1":"0":t(r,s)]),n),[])).toString()}function ar(e){return wt(e)}function ir(e){return wt(e,(t,n)=>t==="tgWebAppData"?ar(n):JSON.stringify(n))}const Et="launchParams";function kt(e){return e.replace(/^[^?#]*[?#]/,"").replace(/[?#]/g,"&")}function Pt(){return v(K(),wn(je))}const ur=B(Pt);function $t(){return v(K(),mn(e=>{const t=new URLSearchParams(e).get("tgWebAppData");return t?pn(t):fn}))}function or(){return v($t(),bn(e=>{throw e},e=>e),dn(()=>{},e=>e))}function K(){const e=[];for(const[t,n]of[[()=>kt(window.location.href),"window.location.href"],[()=>{const r=performance.getEntriesByType("navigation")[0];return r&&kt(r.name)},"performance navigation entries"],[()=>xn(Et),"local storage"]]){const r=t();if(!r){e.push({source:n,error:new Error("Source is empty")});continue}const s=v(je(r),gn(a=>a,()=>!0));if(typeof s!="boolean"){e.push({source:n,error:s});continue}return ct(Et,r),b(r)}return S(new dt(e))}const cr=B(K);function lr(e,t){t()}function q(e,t){t||(t={});const n=t.equals||Object.is;let r=[],s=e;const a=u=>{if(!n(s,u)){const l=s;s=u,lr(c,()=>{[...r].forEach(([p,h])=>{p(u,l),h&&o(p,!0)})})}};function i(u){const l=typeof u!="object"?{once:u}:u;return{once:l.once||!1,signal:l.signal||!1}}const o=(u,l)=>{const p=i(l),h=r.findIndex(([m,$])=>m===u&&$.once===p.once&&$.signal===p.signal);h>=0&&r.splice(h,1)},c=Object.assign(function(){return fr(c),s},{destroy(){r=[]},set:a,reset(){a(e)},sub(u,l){return r.push([u,i(l)]),()=>o(u,l)},unsub:o,unsubAll(){r=r.filter(u=>u[1].signal)}});return c}const H=[];function fr(e){H.length&&H[H.length-1].add(e)}function St(e,t){let n=new Set,r;function s(){return r||(r=q(i(),t))}function a(){s().set(i())}function i(){n.forEach(u=>{u.unsub(a,{signal:!0})});const o=new Set;let c;H.push(o);try{c=e()}finally{H.pop()}return o.forEach(u=>{u.sub(a,{signal:!0})}),n=o,c}return Object.assign(function(){return s()()},{destroy(){s().destroy()},sub(...o){return s().sub(...o)},unsub(...o){s().unsub(...o)},unsubAll(...o){s().unsubAll(...o)}})}function pr(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(s){s(n)}),(r=e.get("*"))&&r.slice().map(function(s){s(t,n)})}}}function _r(e,t){const n=new Map,r=pr(),s=(a,i,o=!1)=>{const c=n.get(a)||new Map;n.set(a,c);const u=c.get(i)||[];c.set(i,u);const l=u.findIndex(p=>p[1]===o);if(l>=0&&(r.off(a,u[l][0]),u.splice(l,1),!u.length&&(c.delete(i),!c.size))){const p=n.size;n.delete(a),p&&!n.size&&t()}};return{on(a,i,o){!n.size&&e();const c=()=>{s(a,i,o)},u=(...h)=>{o&&c(),a==="*"?i({name:h[0],payload:h[1]}):i(...h)};r.on(a,u);const l=n.get(a)||new Map;n.set(a,l);const p=l.get(i)||[];return l.set(i,p),p.push([u,o||!1]),c},off:s,emit:r.emit,clear(){const a=n.size;r.all.clear(),n.clear(),a&&t()}}}function ne(e,t){window.dispatchEvent(new MessageEvent("message",{data:JSON.stringify({eventType:e,eventData:t}),source:window.parent}))}const re=q(!1),Ae=q("https://web.telegram.org"),hr=e=>{O().log("Event received:",e)},Oe=St(re);function dr(e){e!==re()&&(re.set(e),(e?se:Mt)("*",hr))}const Te=St(Ae);function mr(e){Ae.set(e),O().log("New target origin set",e)}const N=q((...e)=>{window.parent.postMessage(...e)}),O=q(ft("Bridge",{bgColor:"#9147ff",textColor:"white",shouldLog:Oe}));function yr(){Rt(),[N,Ae,Te,re,Oe,O].forEach(e=>{e.unsubAll(),"reset"in e&&e.reset()})}function Me(e,t,n){const r=[n],s=e[t];typeof s=="function"&&r.push(s);const a=(...o)=>{r.forEach(c=>c(...o))},i=Object.assign((...o)=>{a(...o)},{unwrap(){const{length:o}=r;if(o===1){delete e[t];return}if(o===2){Ot(e,t,r[1]);return}r.unshift(1),Ot(e,t,a)}});At(e,t,()=>i,o=>r.push(o))}function jt(e,t){const n=e[t];At(e,t,()=>n,r=>{Object.entries(r).forEach(([s,a])=>{n[s]=a})})}function At(e,t,n,r){Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:n,set:r})}function Ot(e,t,n){Object.defineProperty(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n})}const vr={clipboard_text_received:g({req_id:_(),data:L(_())}),custom_method_invoked:g({req_id:_(),result:d(he()),error:d(_())}),popup_closed:L(g({button_id:L(_(),()=>{})}),{}),viewport_changed:L(g({height:W(),width:L(W(),()=>window.innerWidth),is_state_stable:I(),is_expanded:I()}),()=>({height:window.innerHeight,is_state_stable:!0,is_expanded:!0})),theme_changed:g({theme_params:Se()})};function Tt(e){if(e.source!==window.parent)return;let t;try{t=V(C(bt()),e.data)}catch{return}const{eventType:n,eventData:r}=t,s=vr[n];let a;try{a=s?V(s,r):r}catch(i){return O().forceError([`An error occurred processing the "${n}" event from the Telegram application.`,"Please, file an issue here:","https://github.com/Telegram-Mini-Apps/tma.js/issues/new/choose"].join(`
`),t,i)}gr(n,a)}const{on:se,off:Mt,emit:gr,clear:Rt}=_r(()=>{const e=window;!e.TelegramGameProxy&&(e.TelegramGameProxy={}),Me(e.TelegramGameProxy,"receiveEvent",ne),jt(e,"TelegramGameProxy"),!e.Telegram&&(e.Telegram={}),!e.Telegram.WebView&&(e.Telegram.WebView={}),Me(e.Telegram.WebView,"receiveEvent",ne),jt(e.Telegram,"WebView"),Me(e,"TelegramGameProxy_receiveEvent",ne),window.addEventListener("message",Tt)},()=>{[["TelegramGameProxy_receiveEvent"],["TelegramGameProxy","receiveEvent"],["Telegram","WebView","receiveEvent"]].forEach(e=>{const t=window;let n=[void 0,t];for(const a of e)if(n=[n[1],n[1][a]],!n[1])return;const[r,s]=n;"unwrap"in s&&(s.unwrap(),r&&r!==t&&!Object.keys(r).length&&delete t[e[0]])}),window.removeEventListener("message",Tt)}),It=(...e)=>N()(...e);function Ft(e,t){v(x(e,t),vn(n=>{throw n}))}function x(e,t){O().log("Posting event:",t?{eventType:e,eventData:t}:{eventType:e});const n=window,r=JSON.stringify({eventType:e,eventData:t});return me()?(It(r,Te()),b(void 0)):de(n)?(n.TelegramWebviewProxy.postEvent(e,JSON.stringify(t)),b(void 0)):fe(g({external:g({notify:pe()})}),n)?(n.external.notify(r),b(void 0)):S(new $e)}function ae(e,t,n={}){const{capture:r=()=>!0,postEvent:s=x}=n,a=q(),[i,o]=lt();(Array.isArray(t)?t:[t]).forEach(u=>{i(se(u,l=>{const p=Array.isArray(t);r(p?{event:u,payload:l}:l)&&a.set([p?{event:u,payload:l}:l])}))});const c=u=>(o(),u);return v(async()=>s(e,n.params),we(()=>ke((u,l,p)=>{const h=a();if(h)return u(h[0]);const m=T=>{T&&u(T[0])},$=()=>{a.unsub(m)};a.sub(m),p.on("finalized",$)},n)),it(c,c))}function br(e,t,n){const{postEvent:r}=n||{};return J(ae(e,t,{...n,postEvent:r?(...s)=>{try{return r(...s),b(void 0)}catch(a){return S(a)}}:x}))}function wr(e,t){const n=Ct(e,t);return typeof n=="function"?F.fn(()=>J(n)):n}function Ct(e,t){const n=de(window);if(!e)return n||v(K(),G(()=>!1,()=>!0));if(n)return be(!0);const{timeout:r=100}=t||{};return v(ae("web_app_request_theme","theme_changed",{...t,timeout:r}),ee(s=>ve.is(s)||$e.is(s)?b(!1):S(s),()=>b(!0)))}function Er({launchParams:e,onEvent:t,resetPostMessage:n}={}){if(e){const a=typeof e=="string"||e instanceof URLSearchParams?e.toString():ir({...e,tgWebAppData:void 0})+(e.tgWebAppData?`&tgWebAppData=${encodeURIComponent(e.tgWebAppData.toString())}`:"");try{sr(a)}catch(i){throw new mt(a,i)}ct("launchParams",a)}if(me()){if(!t)return;n&&N.reset();const a=N();N.set((...i)=>{const[o]=i,c=()=>{a(...i)};try{const u=V(C(bt()),o);t({name:u.eventType,params:u.eventData},c)}catch{c()}});return}const r=window.TelegramWebviewProxy||{},s=r.postEvent||(()=>{});window.TelegramWebviewProxy={...r,postEvent(a,i){const o=()=>{s(a,i)};t?t({name:a,params:i?JSON.parse(i):void 0},o):o()}},O().log("Environment was mocked by the mockTelegramEnv function")}function qt(e){return({req_id:t})=>t===e}const Lt={"6.0":["iframe_ready","iframe_will_reload","web_app_close","web_app_data_send","web_app_expand","web_app_open_link","web_app_ready","web_app_request_theme","web_app_request_viewport","web_app_setup_main_button","web_app_setup_closing_behavior"],6.1:["web_app_open_tg_link","web_app_open_invoice","web_app_setup_back_button","web_app_set_background_color","web_app_set_header_color","web_app_trigger_haptic_feedback"],6.2:["web_app_open_popup"],6.4:["web_app_close_scan_qr_popup","web_app_open_scan_qr_popup","web_app_read_text_from_clipboard",{method:"web_app_open_link",param:"try_instant_view"}],6.7:["web_app_switch_inline_query"],6.9:["web_app_invoke_custom_method","web_app_request_write_access","web_app_request_phone",{method:"web_app_set_header_color",param:"color"}],"6.10":["web_app_setup_settings_button"],7.2:["web_app_biometry_get_info","web_app_biometry_open_settings","web_app_biometry_request_access","web_app_biometry_request_auth","web_app_biometry_update_token"],7.6:[{method:"web_app_open_link",param:"try_browser"},{method:"web_app_close",param:"return_back"}],7.7:["web_app_setup_swipe_behavior"],7.8:["web_app_share_to_story"],"7.10":["web_app_setup_secondary_button","web_app_set_bottom_bar_color",{method:"web_app_setup_main_button",param:"has_shine_effect"}],"8.0":["web_app_request_safe_area","web_app_request_content_safe_area","web_app_request_fullscreen","web_app_exit_fullscreen","web_app_set_emoji_status","web_app_add_to_home_screen","web_app_check_home_screen","web_app_request_emoji_status_access","web_app_check_location","web_app_open_location_settings","web_app_request_file_download","web_app_request_location","web_app_send_prepared_message","web_app_start_accelerometer","web_app_start_device_orientation","web_app_start_gyroscope","web_app_stop_accelerometer","web_app_stop_device_orientation","web_app_stop_gyroscope","web_app_toggle_orientation_lock"],"9.0":["web_app_device_storage_clear","web_app_device_storage_get_key","web_app_device_storage_save_key","web_app_secure_storage_clear","web_app_secure_storage_get_key","web_app_secure_storage_restore_key","web_app_secure_storage_save_key"],9.1:["web_app_hide_keyboard"]};function Re(e,t){return Object.keys(Lt).find(r=>Lt[r].some(s=>t?typeof s=="object"&&s.method===e&&s.param===t:s===e))||null}function Wt(e){return e.split(".").map(Number)}function Dt(e,t){const n=Wt(e),r=Wt(t),s=Math.max(n.length,r.length);for(let a=0;a<s;a+=1){const i=n[a]||0,o=r[a]||0;if(i!==o)return i>o?1:-1}return 0}function Ie(e,t,n){const r=n?Re(e,t):Re(e);return r?Dt(r,n||t)<=0:!1}function kr(e,t="strict"){const n=typeof t=="function"?t:r=>{const{method:s,version:a}=r,i="param"in r?new ht(s,r.param,a):new _t(s,a);if(t==="strict")throw i;return O().forceWarn(i.message)};return(r,s)=>Ie(r,e)?r==="web_app_set_header_color"&&fe(g({color:Ne()}),s)&&!Ie(r,"color",e)?n({version:e,method:r,param:"color"}):Ft(r,s):n({version:e,method:r})}function Ut(e,t,n,r){return v(ae("web_app_invoke_custom_method","custom_method_invoked",{...r||{},params:{method:e,params:t,req_id:n},capture:qt(n)}),Dn(({result:s,error:a})=>a?at(new yt(a)):be(s)))}function Pr(e,t,n,r){return F.fn(()=>v(Ut(e,t,n,r),ee(s=>{throw s},s=>s))())}function Nt(e,t,n={}){const{capture:r=()=>!0,postEvent:s=x}=n,a=q(),[i,o]=lt();(Array.isArray(t)?t:[t]).forEach(u=>{i(se(u,l=>{(Array.isArray(t)?r({event:u,payload:l}):r(l))&&a.set([l])}))});const c=u=>(o(),u);return v(async()=>s(e,n.params),we(()=>ke((u,l,p)=>{const h=a();if(h)return u(h[0]);const m=T=>{T&&u(T[0])},$=()=>{a.unsub(m)};a.sub(m),p.on("finalized",$)},n)),it(c,c))}function $r(e,t,n){const{postEvent:r}=n||{};return J(Nt(e,t,{...n,postEvent:r?(...s)=>{try{return r(...s),b(void 0)}catch(a){return S(a)}}:x}))}function Sr(){Object.hasOwn||(Object.hasOwn=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)})}function Fe(e){return Z(()=>decodeURIComponent(atob(e.replace(/-/g,"+").replace(/_/g,"/")).split("").map(t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)).join("")),t=>t)}const jr=B(Fe);function Ce(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(t,n)=>String.fromCharCode(parseInt(`0x${n}`)))).replace(/\+/g,"-").replace(/\//g,"_")}function xt(e){const t=Ce(typeof e=="string"?e:JSON.stringify(e));return t.length>512?S(new Error("Value is too long for start parameter")):b(t)}const Ar=B(xt);function Or(e,t){return J(zt(e,typeof t=="function"?n=>Z(()=>t(n),r=>r):t))}function zt(e,t){return v(Fe(e),En(n=>t?typeof t=="function"?t(n):An(n):b(n)))}function Tr(e){return Ce(e).length<=512}return f.CancelledError=Ke,f.InvalidLaunchParamsError=mt,f.InvokeCustomMethodFailedError=yt,f.LaunchParamsRetrieveError=dt,f.MethodParameterUnsupportedError=ht,f.MethodUnsupportedError=_t,f.TimeoutError=ve,f.UnknownEnvError=$e,f.applyPolyfills=Sr,f.captureSameReq=qt,f.compareVersions=Dt,f.createLogger=ft,f.createPostEvent=kr,f.createStartParam=Ar,f.createStartParamFp=xt,f.debug=Oe,f.decodeBase64Url=jr,f.decodeBase64UrlFp=Fe,f.decodeStartParam=Or,f.decodeStartParamFp=zt,f.deepSnakeToCamelObjKeys=Ee,f.emitEvent=ne,f.encodeBase64Url=Ce,f.getReleaseVersion=Re,f.hasWebviewProxy=de,f.invokeCustomMethod=Pr,f.invokeCustomMethodFp=Ut,f.isIframe=me,f.isSafeToCreateStartParam=Tr,f.isTMA=wr,f.isTMAFp=Ct,f.logger=O,f.mockTelegramEnv=Er,f.off=Mt,f.offAll=Rt,f.on=se,f.postEvent=Ft,f.postEventFp=x,f.postMessage=It,f.postMessageImpl=N,f.request=$r,f.request2=br,f.request2Fp=ae,f.requestFp=Nt,f.resetGlobals=yr,f.retrieveLaunchParams=ur,f.retrieveLaunchParamsFp=Pt,f.retrieveRawInitData=or,f.retrieveRawInitDataFp=$t,f.retrieveRawLaunchParams=cr,f.retrieveRawLaunchParamsFp=K,f.setDebug=dr,f.setTargetOrigin=mr,f.supports=Ie,f.targetOrigin=Te,Object.defineProperty(f,Symbol.toStringTag,{value:"Module"}),f}({});
//# sourceMappingURL=index.iife.js.map
